{"version":3,"file":"ValidationError.js","sourceRoot":"","sources":["../../../src/validation/ValidationError.ts"],"names":[],"mappings":"AAAA;;GAEG;AACH,MAAM,OAAO,eAAe;IAuC1B;;;;;OAKG;IACH,QAAQ,CAAC,iBAA0B,KAAK,EAAE,YAAqB,KAAK,EAAE,aAAqB,EAAE;QAC3F,MAAM,SAAS,GAAG,cAAc,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC;QAClD,MAAM,OAAO,GAAG,cAAc,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC;QACjD,MAAM,oBAAoB,GAAG,CAAC,YAAoB,EAAU,EAAE,CAC5D,eAAe,SAAS,GAAG,UAAU,GAAG,YAAY,GAAG,OAAO,0CAA0C,SAAS,GAAG,MAAM,CAAC,IAAI,CAC7H,IAAI,CAAC,WAAW,CACjB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,KAAK,CAAC;QAE9B,IAAI,CAAC,SAAS,EAAE;YACd,OAAO,CACL,kBAAkB,SAAS,GACzB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,WAC/C,GAAG,OAAO,+BAA+B;gBACzC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,oBAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;gBAC7D,CAAC,IAAI,CAAC,QAAQ;oBACZ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC;oBACpG,CAAC,CAAC,EAAE,CAAC,CACR,CAAC;SACH;aAAM;YACL,6DAA6D;YAC7D,MAAM,iBAAiB,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC;gBACxD,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,GAAG;gBACtB,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YAE/C,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,OAAO,oBAAoB,CAAC,iBAAiB,CAAC,CAAC;aAChD;iBAAM;gBACL,OAAO,IAAI,CAAC,QAAQ;oBAClB,CAAC,CAAC,IAAI,CAAC,QAAQ;yBACV,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,cAAc,EAAE,IAAI,EAAE,GAAG,UAAU,GAAG,iBAAiB,EAAE,CAAC,CAAC;yBACjG,IAAI,CAAC,EAAE,CAAC;oBACb,CAAC,CAAC,EAAE,CAAC;aACR;SACF;IACH,CAAC;CACF","sourcesContent":["/**\r\n * Validation error description.\r\n */\r\nexport class ValidationError {\r\n  /**\r\n   * Object that was validated.\r\n   *\r\n   * OPTIONAL - configurable via the ValidatorOptions.validationError.target option\r\n   */\r\n  target?: object;\r\n\r\n  /**\r\n   * Object's property that haven't pass validation.\r\n   */\r\n  property: string;\r\n\r\n  /**\r\n   * Value that haven't pass a validation.\r\n   *\r\n   * OPTIONAL - configurable via the ValidatorOptions.validationError.value option\r\n   */\r\n  value?: any;\r\n\r\n  /**\r\n   * Constraints that failed validation with error messages.\r\n   */\r\n  constraints?: {\r\n    [type: string]: string;\r\n  };\r\n\r\n  /**\r\n   * Contains all nested validation errors of the property.\r\n   */\r\n  children?: ValidationError[];\r\n\r\n  /*\r\n   * A transient set of data passed through to the validation result for response mapping\r\n   */\r\n  contexts?: {\r\n    [type: string]: any;\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param shouldDecorate decorate the message with ANSI formatter escape codes for better readability\r\n   * @param hasParent true when the error is a child of an another one\r\n   * @param parentPath path as string to the parent of this property\r\n   */\r\n  toString(shouldDecorate: boolean = false, hasParent: boolean = false, parentPath: string = ``): string {\r\n    const boldStart = shouldDecorate ? `\\x1b[1m` : ``;\r\n    const boldEnd = shouldDecorate ? `\\x1b[22m` : ``;\r\n    const propConstraintFailed = (propertyName: string): string =>\r\n      ` - property ${boldStart}${parentPath}${propertyName}${boldEnd} has failed the following constraints: ${boldStart}${Object.keys(\r\n        this.constraints\r\n      ).join(`, `)}${boldEnd} \\n`;\r\n\r\n    if (!hasParent) {\r\n      return (\r\n        `An instance of ${boldStart}${\r\n          this.target ? this.target.constructor.name : 'an object'\r\n        }${boldEnd} has failed the validation:\\n` +\r\n        (this.constraints ? propConstraintFailed(this.property) : ``) +\r\n        (this.children\r\n          ? this.children.map(childError => childError.toString(shouldDecorate, true, this.property)).join(``)\r\n          : ``)\r\n      );\r\n    } else {\r\n      // we format numbers as array indexes for better readability.\r\n      const formattedProperty = Number.isInteger(+this.property)\r\n        ? `[${this.property}]`\r\n        : `${parentPath ? `.` : ``}${this.property}`;\r\n\r\n      if (this.constraints) {\r\n        return propConstraintFailed(formattedProperty);\r\n      } else {\r\n        return this.children\r\n          ? this.children\r\n              .map(childError => childError.toString(shouldDecorate, true, `${parentPath}${formattedProperty}`))\r\n              .join(``)\r\n          : ``;\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}